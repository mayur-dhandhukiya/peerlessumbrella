jQuery(document).ready(function(e){"use strict";function t(t){window.top.postMessage({slug:"useyourdrive",action:"wpcp-shortcode",shortcode:t},window.location.origin);var n=e("#wpcp-form").data("callback");""!==n&&window.parent[n](t)}function n(n){var r=e(".UseyourDrive.files").attr("data-token"),a=e(".UseyourDrive[data-token='"+r+"']").attr("data-path"),i=o(".UseyourDrive[data-token='"+r+"'] input[name='selected-files[]']"),d=e(".UseyourDrive.files").attr("data-account-id");return 0===i.length&&t(""),e.ajax({type:"POST",url:UseyourDrive_vars.ajax_url,data:{action:"useyourdrive-create-link",account_id:d,listtoken:r,lastpath:a,entries:i,editable:"editable"===n,_ajax_nonce:UseyourDrive_vars.createlink_nonce},beforeSend:function(){e(".UseyourDrive .loading").height(e(".UseyourDrive .ajax-filelist").height()),e(".UseyourDrive .loading").fadeTo(400,.8),e(".UseyourDrive .wpcp-dropdown-menu-button").attr("disabled","disabled")},complete:function(){e(".UseyourDrive .loading").fadeOut(400),e(".UseyourDrive .wpcp-dropdown-menu-button").removeAttr("disabled")},success:function(o){if(null!==o&&null!==o.links&&o.links.length>0){var r="";e.each(o.links,function(e,t){"download"===n?(t.link="https://drive.google.com/uc?export=download&id="+t.id,!1!==t.resourcekey&&(t.link=t.link+"&resourcekey="+t.resourcekey)):"editable"===n&&(t.link=t.embeddedlink),r+='<a class="UseyourDrive-directlink" href="'+t.link+'" target="_blank">'+t.name+"</a><br/>"}),t(r)}},dataType:"json"}),!1}function o(t){var n=e(t+":checked").map(function(){return this.value}).get();return n}e(".wpcp-dropdown-menu-content a").on("click",function(t){t.stopPropagation(),n(e(this).data("type"))})});